<input id="fileInput" type="file" accept="video/*">
<a-scene embedded arjs="sourceType: webcam; debugUIEnabled:false">

  <a-assets>
    <video id="videoAsset" playsinline webkit-playsinline muted></video>
  </a-assets>

  <a-video id="videoPlane" src="#videoAsset" visible="false" position="0 0 -2" width="1.2" height="0.7" rotation="0 180 0"></a-video>

  <a-entity camera look-controls>
    <a-cursor
      fuse="true"
      fuse-timeout="3000"
      raycaster="objects: .clickable"
      geometry="primitive:ring; radiusInner:0.015; radiusOuter:0.025"
      material="color:white; shader:flat">
    </a-cursor>
  </a-entity>

  <a-entity id="buttons" position="0 -0.4 -2" visible="false">
    <a-plane class="clickable" color="#00ff00" position="-0.6 0 0" width="0.35" height="0.15" text="value:Play;align:center" play-btn></a-plane>
    <a-plane class="clickable" color="#ffff00" position="-0.2 0 0" width="0.35" height="0.15" text="value:Pause;align:center" pause-btn></a-plane>
  </a-entity>

</a-scene>

<script>
const videoEl = document.getElementById('videoAsset');
const videoPlane = document.getElementById('videoPlane');
const buttons = document.getElementById('buttons');
const fileInput = document.getElementById('fileInput');

// Подготовка видео, без автоматического play
fileInput.onchange = e => {
  const file = e.target.files[0];
  if (!file) return;

  videoEl.src = URL.createObjectURL(file);
  videoEl.loop = true;
  videoEl.muted = true; // обязательно для Chrome mobile
  videoEl.setAttribute('muted', '');
  videoPlane.setAttribute('visible', true);
  buttons.setAttribute('visible', true);
};

// Компоненты для кнопок с fuse 3 сек
AFRAME.registerComponent('play-btn', {
  init() {
    this.el.addEventListener('click', () => videoEl.play());
  }
});
AFRAME.registerComponent('pause-btn', {
  init() {
    this.el.addEventListener('click', () => videoEl.pause());
  }
});
</script>
