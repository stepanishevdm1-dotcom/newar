<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AR –í–∏–¥–µ–æ —Å –∂–µ—Å—Ç–∞–º–∏</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        body { 
            margin:0; 
            overflow:hidden;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        #fileInput {
            position:fixed; 
            top:15px; 
            left:50%; 
            transform:translateX(-50%); 
            z-index:100;
            background: rgba(255,255,255,0.95);
            color:#2c3e50;
            padding:12px 25px;
            border-radius:50px;
            border:2px solid #3498db;
            font-size:14px;
            font-weight:600;
            cursor:pointer;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
        }
        
        #fileInput:hover {
            background: white;
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
            transform: translateX(-50%) scale(1.05);
        }
        
        #placeBtn {
            position:fixed; 
            bottom:20px; 
            left:50%;
            transform:translateX(-50%); 
            z-index:100;
            background: linear-gradient(135deg, #3498db 0%, #2ecc71 100%);
            color:white;
            padding:14px 40px;
            border-radius:50px;
            font-size:16px; 
            font-weight:600;
            cursor:pointer;
            border:none;
            box-shadow: 0 6px 20px rgba(46, 204, 113, 0.4);
            transition: all 0.3s ease;
            letter-spacing: 0.5px;
        }
        
        #placeBtn:hover {
            transform: translateX(-50%) scale(1.08);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.6);
        }
        
        #videoTime {
            position: fixed; 
            top: 15px; 
            right: 15px;
            color: white; 
            background: rgba(0,0,0,0.7);
            padding: 8px 15px; 
            border-radius: 25px;
            font-family: 'Monaco', 'Courier New', monospace; 
            z-index: 100;
            font-size: 13px;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
        }
        
        #cameraBtn {
            position: fixed;
            top: 15px;
            left: 15px;
            background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 15px rgba(155, 89, 182, 0.4);
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        #cameraBtn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(155, 89, 182, 0.6);
        }
        
        /* –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∂–µ—Å—Ç–∞—Ö */
        .gesture-info {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 12px;
            z-index: 90;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            text-align: center;
            max-width: 250px;
            display: none;
        }
        
        /* –°—Ç–∞—Ç—É—Å –∂–µ—Å—Ç–æ–≤ */
        #gestureStatus {
            position: fixed;
            top: 60px;
            right: 15px;
            color: white; 
            background: rgba(0,0,0,0.7);
            padding: 8px 12px; 
            border-radius: 15px;
            font-size: 11px;
            z-index: 100;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            display: none;
        }
        
        /* –ö–∞–Ω–≤–∞—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∂–µ—Å—Ç–æ–≤ */
        #gestureCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 90;
            pointer-events: none;
            display: none;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–µ—Å—Ç–∞–º–∏ —Ä—É–∫–∏ */
        #handGesturesBtn {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 10px 15px;
            border-radius: 50px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        #handGesturesBtn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.6);
        }
        
        #handGesturesBtn.active {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4);
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∂–µ—Å—Ç–æ–≤ */
        .gesture-pointer {
            position: fixed;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid #f39c12;
            background: rgba(243, 156, 18, 0.2);
            pointer-events: none;
            z-index: 85;
            display: none;
            transition: all 0.1s ease;
            box-shadow: 0 0 20px rgba(243, 156, 18, 0.5);
        }
        
        /* –°–∫—Ä—ã—Ç–∏–µ VR –∫–Ω–æ–ø–∫–∏ */
        .a-enter-vr {
            display: none !important;
        }
        
        /* –°–∫—Ä—ã—Ç–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ AR.js */
        .a-enter-ar {
            display: none !important;
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loading-spinner {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #3498db;
            animation: spin 1s ease-in-out infinite;
            z-index: 1000;
            display: none;
        }
        
        @keyframes spin {
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –∫–∞–º–µ—Ä—ã */
        .camera-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(5px);
        }
        
        .camera-modal-content {
            background: white;
            padding: 20px;
            border-radius: 15px;
            max-width: 350px;
            width: 80%;
            text-align: center;
        }
        
        .camera-option {
            background: #3498db;
            color: white;
            padding: 12px;
            margin: 8px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .camera-option:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .close-modal {
            background: #e74c3c;
            color: white;
            padding: 8px 16px;
            margin-top: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }
        
        .close-modal:hover {
            background: #c0392b;
        }
        
        /* –ö–Ω–æ–ø–∫–∞ –ø–æ–º–æ—â–∏ */
        #helpBtn {
            position: fixed;
            bottom: 120px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 11px;
            cursor: pointer;
            border: 1px solid rgba(255,255,255,0.2);
            z-index: 100;
            backdrop-filter: blur(5px);
        }
        
        #helpBtn:hover {
            background: rgba(0,0,0,0.8);
        }
        
        /* –ó–æ–Ω–∞ –∂–µ—Å—Ç–æ–≤ */
        .gesture-zone {
            position: fixed;
            bottom: 150px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 200px;
            border: 3px dashed #4fc3f7;
            border-radius: 20px;
            z-index: 80;
            pointer-events: none;
            display: none;
            background: rgba(79, 195, 247, 0.1);
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∂–µ—Å—Ç–æ–≤ –≤ –≤–æ–∑–¥—É—Ö–µ */
        .air-gesture-indicator {
            position: fixed;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: none;
            z-index: 86;
            pointer-events: none;
            font-size: 24px;
            text-align: center;
            line-height: 60px;
            background: rgba(0,0,0,0.5);
            color: white;
            backdrop-filter: blur(10px);
            border: 2px solid white;
        }
    </style>
</head>
<body>
    <input type="file" id="fileInput" accept="video/*">
    <button id="cameraBtn">üì∑ –ö–∞–º–µ—Ä–∞</button>
    <button id="helpBtn">‚ùî –ñ–µ—Å—Ç—ã</button>
    <button id="handGesturesBtn">üëÜ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä—É–∫–æ–π</button>
    <div id="videoTime">00:00 / 00:00</div>
    <div id="placeBtn">üé¨ –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤–∏–¥–µ–æ</div>
    <div class="loading-spinner" id="loadingSpinner"></div>
    
    <!-- –ö–∞–Ω–≤–∞—Å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∂–µ—Å—Ç–æ–≤ -->
    <canvas id="gestureCanvas"></canvas>
    
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∂–µ—Å—Ç–æ–≤ -->
    <div class="gesture-pointer" id="gesturePointer"></div>
    
    <!-- –ó–æ–Ω–∞ –∂–µ—Å—Ç–æ–≤ -->
    <div class="gesture-zone" id="gestureZone"></div>
    
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∂–µ—Å—Ç–æ–≤ –≤ –≤–æ–∑–¥—É—Ö–µ -->
    <div class="air-gesture-indicator" id="pinchIndicator" style="display: none;">üëå</div>
    <div class="air-gesture-indicator" id="openHandIndicator" style="display: none;">ü§ö</div>
    <div class="air-gesture-indicator" id="pointIndicator" style="display: none;">üëÜ</div>
    <div class="air-gesture-indicator" id="fistIndicator" style="display: none;">‚úä</div>
    
    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∂–µ—Å—Ç–∞—Ö -->
    <div class="gesture-info" id="gestureInfo">
        üëÜ –î–≤–∏–≥–∞–π—Ç–µ —Ä—É–∫–æ–π –≤ –∑–æ–Ω–µ –∂–µ—Å—Ç–æ–≤
    </div>
    
    <!-- –°—Ç–∞—Ç—É—Å –∂–µ—Å—Ç–æ–≤ -->
    <div id="gestureStatus">–ñ–µ—Å—Ç—ã: –í—ã–∫–ª—é—á–µ–Ω—ã</div>
    
    <div id="cameraModal" class="camera-modal" style="display: none;">
        <div class="camera-modal-content">
            <h4 style="margin-bottom: 15px; color: #2c3e50;">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–º–µ—Ä—É</h4>
            <div id="cameraOptions"></div>
            <div class="close-modal" id="closeModal">–ó–∞–∫—Ä—ã—Ç—å</div>
        </div>
    </div>
    
    <a-scene 
        embedded 
        arjs='sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;' 
        cursor="rayOrigin: mouse"
        vr-mode-ui="enabled: false"
        id="arScene">
        
        <a-entity camera look-controls>
            <a-cursor id="main-cursor"
                     fuse="true"
                     fuse-timeout="2000"
                     raycaster="objects: .clickable"
                     geometry="primitive: ring; radiusInner: 0.006; radiusOuter: 0.012"
                     material="color: #3498db; shader: flat; opacity: 0.8"
                     position="0 0 -1"
                     animation__click="property: scale; startEvents: click; easing: easeInCubic; dur: 150; from: 0.1 0.1 0.1; to: 1 1 1"
                     animation__fusing="property: scale; startEvents: fusing; easing: easeInCubic; dur: 2000; from: 1 1 1; to: 0.1 0.1 0.1"
                     animation__mouseleave="property: scale; startEvents: mouseleave; easing: easeInCubic; dur: 500; to: 1 1 1"
                     animation__pulse="property: scale; dir: alternate; dur: 1500; easing: easeInOutSine; loop: true; from: 1 1 1; to: 1.2 1.2 1.2">
            </a-cursor>
        </a-entity>
        
        <a-entity light="type: ambient; color: #666; intensity: 0.8"></a-entity>
        <a-entity light="type: directional; color: #fff; intensity: 0.5" position="-1 2 1"></a-entity>
        
    </a-scene>
    
    <script>
        const scene = document.querySelector('a-scene');
        const fileInput = document.getElementById('fileInput');
        const placeBtn = document.getElementById('placeBtn');
        const timeEl = document.getElementById('videoTime');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const cameraBtn = document.getElementById('cameraBtn');
        const cameraModal = document.getElementById('cameraModal');
        const cameraOptions = document.getElementById('cameraOptions');
        const closeModal = document.getElementById('closeModal');
        const gestureInfo = document.getElementById('gestureInfo');
        const gestureStatus = document.getElementById('gestureStatus');
        const helpBtn = document.getElementById('helpBtn');
        const handGesturesBtn = document.getElementById('handGesturesBtn');
        const gestureCanvas = document.getElementById('gestureCanvas');
        const gestureCtx = gestureCanvas.getContext('2d');
        const gesturePointer = document.getElementById('gesturePointer');
        const gestureZone = document.getElementById('gestureZone');
        
        // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∂–µ—Å—Ç–æ–≤
        const pinchIndicator = document.getElementById('pinchIndicator');
        const openHandIndicator = document.getElementById('openHandIndicator');
        const pointIndicator = document.getElementById('pointIndicator');
        const fistIndicator = document.getElementById('fistIndicator');
        
        let videoEl, videoMesh, videoTexture;
        let videoContainer;
        let currentScale = 1;
        let isPlaced = false;
        let firstInteraction = true;
        let playButton, pauseButton, volumeButton;
        let videoWidth = 1.2;
        let videoHeight = 0.8;
        let updateTimeInterval = null;
        let currentCameraId = null;
        let cameras = [];
        let isWideAngleCamera = false;
        let updateVideoRotationInterval = null;
        let isHandGesturesEnabled = false;
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∂–µ—Å—Ç–æ–≤ —Ä—É–∫–æ–π
        let lastGesture = 'none';
        let gestureStartTime = 0;
        let hoverStartTime = 0;
        let currentHoverButton = null;
        let isGestureActive = false;
        let gestureAnimationId = null;
        let mouseX = 0;
        let mouseY = 0;
        let isMouseDown = false;
        let mouseStartX = 0;
        let mouseStartY = 0;
        let startVideoScale = 1;
        let startVideoPosition = new THREE.Vector3();

        // ========== –°–ò–°–¢–ï–ú–ê –ñ–ï–°–¢–û–í –†–£–ö–û–ô –ß–ï–†–ï–ó –ú–´–®–¨/–¢–ê–ß ==========
        
        function initHandGestures() {
            console.log('üîÑ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–µ—Å—Ç–∞–º–∏...');
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–∞–Ω–≤–∞—Å
            gestureCanvas.width = window.innerWidth;
            gestureCanvas.height = window.innerHeight;
            gestureCanvas.style.display = 'block';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–æ–Ω—É –∂–µ—Å—Ç–æ–≤
            gestureZone.style.display = 'block';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            setupGestureHandlers();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∂–µ—Å—Ç–æ–≤
            startGestureAnimation();
            
            console.log('‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–µ—Å—Ç–∞–º–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ');
            isHandGesturesEnabled = true;
            handGesturesBtn.classList.add('active');
            handGesturesBtn.textContent = '‚úã –í—ã–∫–ª –∂–µ—Å—Ç—ã';
            gestureInfo.textContent = 'üëÜ –î–≤–∏–≥–∞–π—Ç–µ –º—ã—à—å—é/–ø–∞–ª—å—Ü–µ–º –≤ –∑–æ–Ω–µ –∂–µ—Å—Ç–æ–≤';
            gestureInfo.style.display = 'block';
            gestureStatus.textContent = '–ñ–µ—Å—Ç—ã: –ê–∫—Ç–∏–≤–Ω—ã';
            gestureStatus.style.display = 'block';
        }
        
        function setupGestureHandlers() {
            // –°–ª–µ–¥–∏–º –∑–∞ –¥–≤–∏–∂–µ–Ω–∏–µ–º –º—ã—à–∏/—Ç–∞—á–∞ –ø–æ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('touchmove', handleTouchMove);
            document.addEventListener('mousedown', handleMouseDown);
            document.addEventListener('mouseup', handleMouseUp);
            document.addEventListener('touchstart', handleTouchStart);
            document.addEventListener('touchend', handleTouchEnd);
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∂–µ—Å—Ç–æ–≤ –≤ –∑–æ–Ω–µ –∂–µ—Å—Ç–æ–≤
            gestureZone.addEventListener('click', handleGestureZoneClick);
        }
        
        function handleMouseMove(e) {
            mouseX = e.clientX;
            mouseY = e.clientY;
            updateGesturePointer(mouseX, mouseY);
        }
        
        function handleTouchMove(e) {
            if (e.touches.length > 0) {
                mouseX = e.touches[0].clientX;
                mouseY = e.touches[0].clientY;
                updateGesturePointer(mouseX, mouseY);
                e.preventDefault();
            }
        }
        
        function handleMouseDown(e) {
            isMouseDown = true;
            mouseStartX = e.clientX;
            mouseStartY = e.clientY;
            
            if (videoContainer) {
                startVideoScale = currentScale;
                startVideoPosition.copy(videoContainer.position);
            }
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∂–µ—Å—Ç–∞ –ø–æ –ø–æ–∑–∏—Ü–∏–∏
            detectGestureType(e.clientX, e.clientY, 'start');
        }
        
        function handleMouseUp(e) {
            isMouseDown = false;
            lastGesture = 'none';
            hideAllGestureIndicators();
        }
        
        function handleTouchStart(e) {
            if (e.touches.length > 0) {
                isMouseDown = true;
                mouseStartX = e.touches[0].clientX;
                mouseStartY = e.touches[0].clientY;
                
                if (videoContainer) {
                    startVideoScale = currentScale;
                    startVideoPosition.copy(videoContainer.position);
                }
                
                detectGestureType(e.touches[0].clientX, e.touches[0].clientY, 'start');
            }
        }
        
        function handleTouchEnd(e) {
            isMouseDown = false;
            lastGesture = 'none';
            hideAllGestureIndicators();
        }
        
        function handleGestureZoneClick(e) {
            // –ö–ª–∏–∫ –≤ –∑–æ–Ω–µ –∂–µ—Å—Ç–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
            const rect = gestureZone.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            // –†–∞–∑–¥–µ–ª—è–µ–º –∑–æ–Ω—É –Ω–∞ 4 —á–∞—Å—Ç–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∂–µ—Å—Ç–æ–≤
            const zoneWidth = rect.width;
            const zoneHeight = rect.height;
            
            if (x < zoneWidth / 2 && y < zoneHeight / 2) {
                // –í–µ—Ä—Ö–Ω–∏–π –ª–µ–≤—ã–π —É–≥–æ–ª - —â–µ–ø–æ–∫ (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)
                simulatePinchGesture();
            } else if (x >= zoneWidth / 2 && y < zoneHeight / 2) {
                // –í–µ—Ä—Ö–Ω–∏–π –ø—Ä–∞–≤—ã–π —É–≥–æ–ª - –æ—Ç–∫—Ä—ã—Ç–∞—è –ª–∞–¥–æ–Ω—å (–ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ)
                simulateOpenHandGesture();
            } else if (x < zoneWidth / 2 && y >= zoneHeight / 2) {
                // –ù–∏–∂–Ω–∏–π –ª–µ–≤—ã–π —É–≥–æ–ª - —É–∫–∞–∑–∞–Ω–∏–µ (–∫–Ω–æ–ø–∫–∏)
                simulatePointGesture();
            } else {
                // –ù–∏–∂–Ω–∏–π –ø—Ä–∞–≤—ã–π —É–≥–æ–ª - –∫—É–ª–∞–∫ (—Å–±—Ä–æ—Å)
                simulateFistGesture();
            }
        }
        
        function updateGesturePointer(x, y) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é —É–∫–∞–∑–∞—Ç–µ–ª—è
            gesturePointer.style.left = (x - 20) + 'px';
            gesturePointer.style.top = (y - 20) + 'px';
            gesturePointer.style.display = 'block';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –≤ –∑–æ–Ω–µ –∂–µ—Å—Ç–æ–≤
            const rect = gestureZone.getBoundingClientRect();
            const inGestureZone = x >= rect.left && x <= rect.right && 
                                 y >= rect.top && y <= rect.bottom;
            
            if (inGestureZone) {
                gesturePointer.style.borderColor = '#4fc3f7';
                gesturePointer.style.background = 'rgba(79, 195, 247, 0.3)';
                gesturePointer.style.boxShadow = '0 0 30px rgba(79, 195, 247, 0.7)';
                
                if (isMouseDown) {
                    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∂–µ—Å—Ç
                    processActiveGesture(x, y);
                } else {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É –¥–ª—è –∂–µ—Å—Ç–∞
                    showGestureHint(x, y, rect);
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ –∫–Ω–æ–ø–∫–∏ AR
                if (isPlaced) {
                    checkButtonHover(x, y);
                }
            } else {
                gesturePointer.style.borderColor = '#f39c12';
                gesturePointer.style.background = 'rgba(243, 156, 18, 0.2)';
                gesturePointer.style.boxShadow = '0 0 20px rgba(243, 156, 18, 0.5)';
                
                if (isMouseDown && isPlaced) {
                    // –ï—Å–ª–∏ –≤–Ω–µ –∑–æ–Ω—ã –∂–µ—Å—Ç–æ–≤, –Ω–æ –≤–∏–¥–µ–æ —Ä–∞–∑–º–µ—â–µ–Ω–æ - –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–Ω–æ–ø–∫–∏
                    checkButtonHover(x, y);
                }
            }
        }
        
        function detectGestureType(x, y, phase) {
            const rect = gestureZone.getBoundingClientRect();
            const zoneX = x - rect.left;
            const zoneY = y - rect.top;
            const zoneWidth = rect.width;
            const zoneHeight = rect.height;
            
            if (zoneX >= 0 && zoneX <= zoneWidth && zoneY >= 0 && zoneY <= zoneHeight) {
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∂–µ—Å—Ç–∞ –ø–æ –ø–æ–∑–∏—Ü–∏–∏ –≤ –∑–æ–Ω–µ
                if (zoneX < zoneWidth / 3) {
                    if (zoneY < zoneHeight / 3) {
                        lastGesture = 'pinch';
                        showGestureIndicator('pinch', x, y);
                        gestureInfo.textContent = 'üëå –©–µ–ø–æ–∫: –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ';
                    } else if (zoneY < 2 * zoneHeight / 3) {
                        lastGesture = 'point';
                        showGestureIndicator('point', x, y);
                        gestureInfo.textContent = 'üëÜ –£–∫–∞–∑–∞–Ω–∏–µ: –Ω–∞–≤–µ–¥–µ–Ω–∏–µ';
                    } else {
                        lastGesture = 'fist';
                        showGestureIndicator('fist', x, y);
                        gestureInfo.textContent = '‚úä –ö—É–ª–∞–∫: —Å–±—Ä–æ—Å';
                    }
                } else if (zoneX < 2 * zoneWidth / 3) {
                    lastGesture = 'open';
                    showGestureIndicator('open', x, y);
                    gestureInfo.textContent = 'ü§ö –õ–∞–¥–æ–Ω—å: –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ';
                }
            }
        }
        
        function processActiveGesture(x, y) {
            if (!videoContainer || !isPlaced) return;
            
            const deltaX = x - mouseStartX;
            const deltaY = y - mouseStartY;
            const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
            
            switch(lastGesture) {
                case 'pinch':
                    // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è
                    const scaleFactor = 1 + (deltaY / window.innerHeight) * 2;
                    currentScale = Math.max(0.3, Math.min(3, startVideoScale * scaleFactor));
                    videoContainer.scale.set(currentScale, currentScale, currentScale);
                    updateButtonPositions();
                    
                    gestureInfo.textContent = `üëå –ú–∞—Å—à—Ç–∞–±: ${Math.round(currentScale * 100)}%`;
                    break;
                    
                case 'open':
                    // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–≤–∏–∂–µ–Ω–∏—è
                    const moveX = deltaX / window.innerWidth * 2;
                    const moveY = -deltaY / window.innerHeight * 2;
                    
                    videoContainer.position.x = startVideoPosition.x + moveX;
                    videoContainer.position.y = startVideoPosition.y + moveY;
                    
                    gestureInfo.textContent = 'ü§ö –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–∏–¥–µ–æ';
                    break;
                    
                case 'point':
                    // –£–∫–∞–∑–∞–Ω–∏–µ - —É–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ checkButtonHover
                    gestureInfo.textContent = 'üëÜ –£–∫–∞–∂–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É';
                    break;
                    
                case 'fist':
                    // –ö—É–ª–∞–∫ - —Å–±—Ä–æ—Å —á–µ—Ä–µ–∑ —É–¥–µ—Ä–∂–∞–Ω–∏–µ
                    if (Date.now() - gestureStartTime > 2000) {
                        resetVideoSettings();
                        gestureInfo.textContent = '‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã!';
                    } else {
                        gestureInfo.textContent = '‚úä –£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –¥–ª—è —Å–±—Ä–æ—Å–∞...';
                    }
                    break;
            }
        }
        
        function showGestureHint(x, y, zoneRect) {
            const zoneX = x - zoneRect.left;
            const zoneY = y - zoneRect.top;
            const zoneWidth = zoneRect.width;
            const zoneHeight = zoneRect.height;
            
            // –†–∞–∑–¥–µ–ª—è–µ–º –∑–æ–Ω—É –Ω–∞ 4 —Å–µ–∫—Ç–æ—Ä–∞ —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏
            let hint = '';
            
            if (zoneX < zoneWidth / 2 && zoneY < zoneHeight / 2) {
                hint = 'üëå –©–µ–ø–æ–∫ - –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ';
            } else if (zoneX >= zoneWidth / 2 && zoneY < zoneHeight / 2) {
                hint = 'ü§ö –õ–∞–¥–æ–Ω—å - –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ';
            } else if (zoneX < zoneWidth / 2 && zoneY >= zoneHeight / 2) {
                hint = 'üëÜ –£–∫–∞–∑–∞–Ω–∏–µ - –∫–Ω–æ–ø–∫–∏';
            } else {
                hint = '‚úä –ö—É–ª–∞–∫ - —Å–±—Ä–æ—Å';
            }
            
            gestureInfo.textContent = hint;
        }
        
        function checkButtonHover(screenX, screenY) {
            if (!videoContainer || !isPlaced) return;
            
            const buttons = [
                { element: playButton, action: 'play', name: 'Play' },
                { element: pauseButton, action: 'pause', name: 'Pause' },
                { element: volumeButton, action: 'toggleVolume', name: 'Volume' }
            ];
            
            let hovered = null;
            
            buttons.forEach(({ element, action, name }) => {
                if (!element) return;
                
                // –ü–æ–ª—É—á–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –∫–Ω–æ–ø–∫–∏ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
                const buttonPos = new THREE.Vector3();
                element.getWorldPosition(buttonPos);
                buttonPos.project(scene.camera);
                
                const buttonX = (buttonPos.x * 0.5 + 0.5) * window.innerWidth;
                const buttonY = (1 - (buttonPos.y * 0.5 + 0.5)) * window.innerHeight;
                
                const distance = Math.sqrt(
                    Math.pow(screenX - buttonX, 2) + Math.pow(screenY - buttonY, 2)
                );
                
                if (distance < 80) {
                    hovered = { element, action, name };
                    
                    // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                    element.children[1].material.emissive.setHex(0x888888);
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —É–∫–∞–∑–∞—Ç–µ–ª—å
                    gesturePointer.style.width = '60px';
                    gesturePointer.style.height = '60px';
                    gesturePointer.style.borderColor = '#2ecc71';
                    gesturePointer.style.boxShadow = '0 0 40px rgba(46, 204, 113, 0.8)';
                    
                    if (currentHoverButton !== element) {
                        currentHoverButton = element;
                        hoverStartTime = Date.now();
                    } else if (Date.now() - hoverStartTime > 1000) {
                        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –ø–æ—Å–ª–µ 1 —Å–µ–∫—É–Ω–¥—ã
                        executeButtonAction(action);
                        hoverStartTime = Date.now();
                        
                        // –ê–Ω–∏–º–∞—Ü–∏—è –Ω–∞–∂–∞—Ç–∏—è
                        gesturePointer.style.transform = 'scale(0.7)';
                        setTimeout(() => {
                            gesturePointer.style.transform = 'scale(1)';
                        }, 200);
                        
                        gestureInfo.textContent = `‚úÖ ${name} –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!`;
                        
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º hover –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è
                        setTimeout(() => {
                            currentHoverButton = null;
                        }, 500);
                    } else {
                        const timeLeft = Math.ceil((1000 - (Date.now() - hoverStartTime)) / 1000);
                        gestureInfo.textContent = `üëÜ –£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ ${timeLeft}—Å –¥–ª—è ${name}`;
                    }
                } else {
                    element.children[1].material.emissive.setHex(0x000000);
                    
                    if (currentHoverButton === element) {
                        currentHoverButton = null;
                    }
                }
            });
            
            if (!hovered) {
                gesturePointer.style.width = '40px';
                gesturePointer.style.height = '40px';
                gesturePointer.style.transform = 'scale(1)';
                
                if (lastGesture === 'point') {
                    gesturePointer.style.borderColor = '#f39c12';
                    gesturePointer.style.boxShadow = '0 0 30px rgba(243, 156, 18, 0.7)';
                }
            }
        }
        
        function showGestureIndicator(type, x, y) {
            hideAllGestureIndicators();
            
            let indicator;
            switch(type) {
                case 'pinch':
                    indicator = pinchIndicator;
                    break;
                case 'open':
                    indicator = openHandIndicator;
                    break;
                case 'point':
                    indicator = pointIndicator;
                    break;
                case 'fist':
                    indicator = fistIndicator;
                    break;
            }
            
            if (indicator) {
                indicator.style.left = (x - 30) + 'px';
                indicator.style.top = (y - 30) + 'px';
                indicator.style.display = 'block';
                gestureStartTime = Date.now();
            }
        }
        
        function hideAllGestureIndicators() {
            pinchIndicator.style.display = 'none';
            openHandIndicator.style.display = 'none';
            pointIndicator.style.display = 'none';
            fistIndicator.style.display = 'none';
        }
        
        function simulatePinchGesture() {
            if (!videoContainer) return;
            
            // –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
            const targetScale = currentScale > 1.5 ? 1 : 2;
            animateScaleChange(targetScale);
            
            showGestureIndicator('pinch', window.innerWidth / 4, window.innerHeight / 4);
            gestureInfo.textContent = `üëå –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ: ${Math.round(targetScale * 100)}%`;
        }
        
        function simulateOpenHandGesture() {
            if (!videoContainer) return;
            
            // –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ
            const targetX = videoContainer.position.x === 0 ? 1 : 0;
            const targetY = videoContainer.position.y === 0 ? 0.5 : 0;
            
            animatePositionChange(targetX, targetY);
            
            showGestureIndicator('open', 3 * window.innerWidth / 4, window.innerHeight / 4);
            gestureInfo.textContent = 'ü§ö –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤–∏–¥–µ–æ';
        }
        
        function simulatePointGesture() {
            showGestureIndicator('point', window.innerWidth / 4, 3 * window.innerHeight / 4);
            gestureInfo.textContent = 'üëÜ –£–∫–∞–∂–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É';
        }
        
        function simulateFistGesture() {
            resetVideoSettings();
            showGestureIndicator('fist', 3 * window.innerWidth / 4, 3 * window.innerHeight / 4);
            gestureInfo.textContent = '‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã!';
        }
        
        function animateScaleChange(targetScale) {
            const startScale = currentScale;
            const duration = 500; // –º—Å
            const startTime = Date.now();
            
            function animate() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
                const easedProgress = 1 - Math.pow(1 - progress, 3);
                currentScale = startScale + (targetScale - startScale) * easedProgress;
                
                if (videoContainer) {
                    videoContainer.scale.set(currentScale, currentScale, currentScale);
                    updateButtonPositions();
                }
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                }
            }
            
            animate();
        }
        
        function animatePositionChange(targetX, targetY) {
            const startX = videoContainer.position.x;
            const startY = videoContainer.position.y;
            const duration = 500;
            const startTime = Date.now();
            
            function animate() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const easedProgress = 1 - Math.pow(1 - progress, 3);
                videoContainer.position.x = startX + (targetX - startX) * easedProgress;
                videoContainer.position.y = startY + (targetY - startY) * easedProgress;
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                }
            }
            
            animate();
        }
        
        function resetVideoSettings() {
            if (!videoContainer) return;
            
            currentScale = 1;
            videoContainer.scale.set(currentScale, currentScale, currentScale);
            videoContainer.position.set(0, 0, -1.5);
            videoContainer.rotation.set(0, 0, 0);
            updateButtonPositions();
            updateVideoRotation();
        }
        
        function startGestureAnimation() {
            // –û—á–∏—â–∞–µ–º –∫–∞–Ω–≤–∞—Å
            gestureCtx.clearRect(0, 0, gestureCanvas.width, gestureCanvas.height);
            
            // –†–∏—Å—É–µ–º –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∂–µ—Å—Ç–æ–≤
            drawGestureVisualization();
            
            // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            gestureAnimationId = requestAnimationFrame(startGestureAnimation);
        }
        
        function drawGestureVisualization() {
            const centerX = gestureCanvas.width / 2;
            const centerY = gestureCanvas.height / 2;
            const time = Date.now() * 0.001;
            
            // –†–∏—Å—É–µ–º –≤–æ–ª–Ω—ã –∂–µ—Å—Ç–æ–≤
            gestureCtx.strokeStyle = 'rgba(79, 195, 247, 0.3)';
            gestureCtx.lineWidth = 2;
            
            for (let i = 0; i < 3; i++) {
                const radius = 50 + i * 30 + Math.sin(time + i) * 20;
                gestureCtx.beginPath();
                gestureCtx.arc(centerX, centerY, radius, 0, Math.PI * 2);
                gestureCtx.stroke();
            }
            
            // –†–∏—Å—É–µ–º –∏–∫–æ–Ω–∫–∏ –∂–µ—Å—Ç–æ–≤ –≤ —É–≥–ª–∞—Ö
            drawGestureIcons();
        }
        
        function drawGestureIcons() {
            const icons = ['üëå', 'ü§ö', 'üëÜ', '‚úä'];
            const positions = [
                { x: 100, y: 100 },
                { x: gestureCanvas.width - 100, y: 100 },
                { x: 100, y: gestureCanvas.height - 100 },
                { x: gestureCanvas.width - 100, y: gestureCanvas.height - 100 }
            ];
            
            gestureCtx.font = '40px Arial';
            gestureCtx.textAlign = 'center';
            gestureCtx.textBaseline = 'middle';
            
            positions.forEach((pos, index) => {
                // –§–æ–Ω –¥–ª—è –∏–∫–æ–Ω–∫–∏
                gestureCtx.fillStyle = 'rgba(0, 0, 0, 0.5)';
                gestureCtx.beginPath();
                gestureCtx.arc(pos.x, pos.y, 30, 0, Math.PI * 2);
                gestureCtx.fill();
                
                // –ò–∫–æ–Ω–∫–∞
                gestureCtx.fillStyle = 'white';
                gestureCtx.fillText(icons[index], pos.x, pos.y);
            });
        }
        
        function stopHandGestures() {
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            if (gestureAnimationId) {
                cancelAnimationFrame(gestureAnimationId);
                gestureAnimationId = null;
            }
            
            // –£–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            document.removeEventListener('mousemove', handleMouseMove);
            document.removeEventListener('touchmove', handleTouchMove);
            document.removeEventListener('mousedown', handleMouseDown);
            document.removeEventListener('mouseup', handleMouseUp);
            document.removeEventListener('touchstart', handleTouchStart);
            document.removeEventListener('touchend', handleTouchEnd);
            
            // –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
            gestureCanvas.style.display = 'none';
            gesturePointer.style.display = 'none';
            gestureZone.style.display = 'none';
            hideAllGestureIndicators();
            gestureCtx.clearRect(0, 0, gestureCanvas.width, gestureCanvas.height);
            
            isHandGesturesEnabled = false;
            handGesturesBtn.classList.remove('active');
            handGesturesBtn.textContent = 'üëÜ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä—É–∫–æ–π';
            gestureStatus.style.display = 'none';
            gestureInfo.style.display = 'none';
        }
        
        handGesturesBtn.addEventListener('click', () => {
            if (isHandGesturesEnabled) {
                stopHandGestures();
            } else {
                initHandGestures();
            }
        });
        
        // ========== –û–°–¢–ê–õ–¨–ù–û–ô –ö–û–î (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ==========
        
        function updateVideoRotation() {
            if (!videoContainer || !scene.camera) return;
            
            const camera = scene.camera;
            const cameraPosition = camera.getWorldPosition(new THREE.Vector3());
            const videoPosition = videoContainer.getWorldPosition(new THREE.Vector3());
            
            const direction = new THREE.Vector3()
                .subVectors(cameraPosition, videoPosition)
                .normalize();
            
            const angleY = Math.atan2(direction.x, direction.z);
            const horizontalDistance = Math.sqrt(direction.x * direction.x + direction.z * direction.z);
            const angleX = Math.atan2(-direction.y, horizontalDistance);
            
            videoContainer.rotation.x = angleX;
            videoContainer.rotation.y = angleY;
            videoContainer.rotation.z = 0;
            
            if (playButton) {
                playButton.rotation.x = -angleX;
                playButton.rotation.y = 0;
                playButton.rotation.z = 0;
            }
            if (pauseButton) {
                pauseButton.rotation.x = -angleX;
                pauseButton.rotation.y = 0;
                pauseButton.rotation.z = 0;
            }
            if (volumeButton) {
                volumeButton.rotation.x = -angleX;
                volumeButton.rotation.y = 0;
                volumeButton.rotation.z = 0;
            }
        }
        
        function startVideoRotationUpdate() {
            if (updateVideoRotationInterval) {
                clearInterval(updateVideoRotationInterval);
            }
            updateVideoRotationInterval = setInterval(updateVideoRotation, 50);
        }
        
        // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–∫–∏–º –∂–µ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ ...
        
        // –ò–∑–º–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç—ã—Ö –∂–µ—Å—Ç–æ–≤:
        function initSimpleGestures() {
            // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–≤—É–º—è –ø–∞–ª—å—Ü–∞–º–∏
            scene.addEventListener('touchstart', e => {
                if(e.touches.length == 2 && videoContainer && !isHandGesturesEnabled){
                    const dx = e.touches[0].clientX - e.touches[1].clientX;
                    const dy = e.touches[0].clientY - e.touches[1].clientY;
                    startDistance = Math.sqrt(dx*dx + dy*dy);
                    startScale = videoContainer.scale.x;
                    showGestureInfo('üëå –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ: –¥–≤–∏–≥–∞–π—Ç–µ –ø–∞–ª—å—Ü–∞–º–∏');
                }
            });
            
            scene.addEventListener('touchmove', e => {
                if(e.touches.length == 2 && videoContainer && startDistance && !isHandGesturesEnabled){
                    e.preventDefault();
                    const dx = e.touches[0].clientX - e.touches[1].clientX;
                    const dy = e.touches[0].clientY - e.touches[1].clientY;
                    const currentDistance = Math.sqrt(dx*dx + dy*dy);
                    const scaleFactor = currentDistance / startDistance;

                    const newScale = Math.max(0.1, Math.min(5, startScale * scaleFactor));
                    videoContainer.scale.set(newScale, newScale, newScale);
                    currentScale = newScale;
                    
                    updateButtonPositions();
                    showGestureInfo(`–†–∞–∑–º–µ—Ä: ${Math.round(currentScale * 100)}%`);
                }
            });
            
            // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∂–µ—Å—Ç–æ–≤ ...
        }
        
        // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
        
        // –§—É–Ω–∫—Ü–∏–∏ createButtons, createModernButton, createButtonIcon, 
        // createAFrameButtons, executeButtonAction, updateButtonPositions
        // –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
        
        // –§—É–Ω–∫—Ü–∏—è showGestureInfo:
        function showGestureInfo(text) {
            if (!isHandGesturesEnabled) {
                gestureInfo.textContent = text;
                gestureInfo.style.display = 'block';
                gestureStatus.style.display = 'block';
                
                setTimeout(() => {
                    gestureInfo.style.display = 'none';
                }, 2000);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            // –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∫–∞–Ω–≤–∞—Å–∞
            window.addEventListener('resize', () => {
                gestureCanvas.width = window.innerWidth;
                gestureCanvas.height = window.innerHeight;
            });
            
            console.log('üé¨ AR –í–∏–¥–µ–æ —Å –∂–µ—Å—Ç–∞–º–∏ –≥–æ—Ç–æ–≤–æ!');
            console.log('üëÜ –ù–∞–∂–º–∏—Ç–µ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä—É–∫–æ–π" –¥–ª—è –∂–µ—Å—Ç–æ–≤ –≤ –≤–æ–∑–¥—É—Ö–µ');
        });
        
        // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ (getAvailableCameras, switchCamera, fileInput –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç.–¥.)
        // –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–∫–∏–º –∂–µ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
        
    </script>
</body>
</html>
